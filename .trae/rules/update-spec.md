# 代码修改与规格说明书同步规则

## 编码准则

### 前端显示逻辑与计算逻辑分离
- **核心原则**：所有前端显示逻辑必须与计算逻辑分离，确保代码结构清晰，职责明确。
- **具体要求**：
  - 计算逻辑应封装在独立的模块中（如 `calculator.ts`、`engine.ts`、`atb.ts` 等），专注于数据处理和业务逻辑。
  - 显示逻辑应集中在 UI 模块中（如 `ui.ts`），只负责界面渲染和用户交互，不直接处理计算或修改状态。
  - 模块间通信应优先使用事件系统，避免直接引用和依赖。
  - UI 模块如需获取计算结果，应通过事件或代理方法获取，不直接调用计算模块的内部方法。
- **实施方法**：
  - 新增计算功能时，应先创建独立的计算模块或在现有计算模块中添加方法。
  - UI 模块应通过事件监听器响应数据变化，触发界面更新。
  - 状态修改应在计算模块中进行，通过事件通知 UI 模块更新显示。

## 规则目的
确保代码修改与设计规格说明书（spec）保持同步，提高代码可维护性和项目一致性。

## 适用范围
本规则适用于所有对项目代码的修改，包括但不限于：
- 功能实现
- Bug修复
- 代码重构
- 性能优化

## 具体要求
1. **修改前检查**：在修改代码前，先查看相关的设计规格说明，确保理解当前实现的设计意图。

2. **修改后更新**：
   - 当代码修改涉及到功能变更时，必须同步更新 `.trae/spec/` 目录下的相关规格说明文档。
   - 当代码修改影响到数据结构、界面设计或核心逻辑时，必须在规格说明文档中反映这些变化。

3. **文档格式**：
   - 规格说明文档应使用 Markdown 格式。
   - 文档结构应清晰，包含必要的章节和示例。
   - 代码示例应与实际代码保持一致。

4. **版本控制**：
   - 规格说明文档应与代码一起纳入版本控制系统。
   - 提交代码时，应同时提交对应的规格说明文档更新。

5. **审核流程**：
   - 代码审查时，应同时审查规格说明文档的更新。
   - 确保代码实现与规格说明文档描述的功能一致。

## 违反规则的后果
- 代码可能与设计意图不一致，导致功能错误或维护困难。
- 新成员可能难以理解代码的设计意图和实现逻辑。
- 项目文档与实际实现脱节，影响项目的整体质量。

## 例外情况
- 对代码的微小修改（如变量名调整、注释添加等）不需要更新规格说明文档。
- 对性能优化的修改，若不影响功能和接口，则不需要更新规格说明文档。

## 全局技能路径
- **全局技能存储位置**：`C:\Users\zzb\.agents\skills`
- **说明**：该目录存储系统级别的全局技能，如 `browser-use` 和 `find-skills` 等。这些技能可在所有项目中使用，无需在每个项目中重复配置。